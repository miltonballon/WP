CREATE TABLE `Invoice` (
	`id`			INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	`n_invoice`		TEXT,
	`n_autorization`	TEXT,
	`id_provider`		INTEGER,
	`date`			TEXT,
	`id_trimester`		INTEGER,
	FOREIGN KEY(`id_provider`) REFERENCES `Provider`(`id`),
	FOREIGN KEY(`id_trimester`) REFERENCES `trimester`(`id`)
	CONSTRAINT n_invoice_provider_unique UNIQUE (n_invoice, id_provider)
);

CREATE TABLE `Product` (
	`id`	INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	`name`	TEXT,
	`clasification`	TEXT
);
CREATE TABLE `Provider` (
	`id`	INTEGER PRIMARY KEY AUTOINCREMENT,
	`name`		TEXT,
	`NIT`		TEXT
	
);
CREATE TABLE `Contact` (
	`id`	INTEGER PRIMARY KEY AUTOINCREMENT,
	`name`		TEXT,
	`phone`		TEXT,
	`id_provider`	INTEGER,	
	FOREIGN KEY(`id_provider`) REFERENCES `Provider`(`id`)	
);
CREATE TABLE `Unit` (
	`id`	INTEGER PRIMARY KEY AUTOINCREMENT,
	`Type`	TEXT
);
CREATE TABLE `Product_Provider_Unit` (
	`id`	INTEGER PRIMARY KEY AUTOINCREMENT,	
	`id_product`	INTEGER,
	`id_provider`	INTEGER,
	`id_unit`	INTEGER,
	FOREIGN KEY(`id_provider`) REFERENCES `Provider`(`id`),
	FOREIGN KEY(`id_unit`) REFERENCES `Unit`(`id`),
	FOREIGN KEY(`id_product`) REFERENCES `Product`(`id`)
);

CREATE TABLE `invoice_row` (
	`id`		INTEGER PRIMARY KEY AUTOINCREMENT,
	`id_invoice`	INTEGER,
	`id_ppu`	INTEGER,
	`quantity`	TEXT,
	`unit_price`	TEXT,
	`total` 	TEXT,
	FOREIGN KEY(`id_ppu`) REFERENCES `Product_Provider_Unit`(`id`),
	FOREIGN KEY(`id_invoice`) REFERENCES `Invoice`(`id`)	
);

CREATE TABLE `Configuration` (
	`id`		INTEGER PRIMARY KEY AUTOINCREMENT,
	`scholarships`	INTEGER,
	`n_departure`	INTEGER,
	`days_left`	INTEGER,
	`minimum_quantity` INTEGER

);

CREATE TABLE `trimester` (
	`id`		INTEGER PRIMARY KEY AUTOINCREMENT,
	`open`		INTEGER,
	`name`		TEXT,
	`initial_date`	TEXT,
	`end_date`	TEXT
);

CREATE TABLE `User` (
	`id`		INTEGER PRIMARY KEY AUTOINCREMENT,
	`name`	TEXT,
	`password`	TEXT,
	`email`	TEXT
);
CREATE TABLE `Reception` (
	`id`	INTEGER PRIMARY KEY AUTOINCREMENT,
	`ppu_id`	INTEGER,
	`receptionDate`	TEXT,
	`expirationDate`	TEXT,
	`total`	INTEGER,
	FOREIGN KEY(`ppu_id`) REFERENCES `Product_Provider_Unit`(`id`)
);
CREATE TABLE `OutputReception` (
	`id`	INTEGER PRIMARY KEY AUTOINCREMENT,
	`id_reception`	INTEGER,
	`output_total`	INTEGER,
	`output_date`	TEXT,
	FOREIGN KEY(`id_reception`) REFERENCES `Reception`(`id`)
);

CREATE TABLE `Report` (
	`id`		INTEGER PRIMARY KEY AUTOINCREMENT,
	`name`		TEXT,
	`date`		TEXT,
	`id_trimester`	INTEGER,
	FOREIGN KEY(`id_trimester`) REFERENCES `trimester`(`id`)
);

CREATE TABLE `Report_sheet` (
	`id`	INTEGER PRIMARY KEY AUTOINCREMENT,
	`id_report`	INTEGER,
	`type`		TEXT,
	`tittle`	TEXT,
	FOREIGN KEY(`id_report`) REFERENCES `Report`(`id`)
);

CREATE TABLE `Report_sheet_cell` (
	`id`			INTEGER PRIMARY KEY AUTOINCREMENT,
	`id_report_sheet`	INTEGER,
	`row`			INTEGER,
	`column`		INTEGER,
	`content`		TEXT,
	`styles`		TEXT,
	FOREIGN KEY(`id_report_sheet`) REFERENCES `Report_sheet`(`id`)
);
CREATE TABLE `Inventory` (
	`id`	INTEGER PRIMARY KEY AUTOINCREMENT,
	`ppu_id`	INTEGER,
	`stock`	INTEGER,
	FOREIGN KEY(`ppu_id`) REFERENCES `Product_Provider_Unit`(`id`)
);
INSERT INTO Product(name, clasification) VALUES ('Pan','Fresco');
INSERT INTO Product(name, clasification) VALUES ('Leche','Fresco');
INSERT INTO Product(name, clasification) VALUES ('Carne Para Sopa','Fresco');
INSERT INTO Product(name, clasification) VALUES ('Arroz','Seco');
INSERT INTO Product(name, clasification) VALUES ('Leche Formula','Seco');

INSERT INTO Unit(Type) VALUES ('Bolsa');
INSERT INTO Unit(Type) VALUES ('Lts.');
INSERT INTO Unit(Type) VALUES ('Kg.');
INSERT INTO Unit(Type) VALUES ('Lata');

INSERT INTO Provider(Provider, NIT) VALUES ('HiperMaxi',123);
INSERT INTO Provider(Provider, NIT) VALUES ('FarmaCorp',456);

INSERT INTO Product_Provider_Unit(id_prod, id_prov, id_uni) VALUES (1, 1, 1);
INSERT INTO Product_Provider_Unit(id_prod, id_prov, id_uni) VALUES (2, 1, 2);
INSERT INTO Product_Provider_Unit(id_prod, id_prov, id_uni) VALUES (3, 1, 3);
INSERT INTO Product_Provider_Unit(id_prod, id_prov, id_uni) VALUES (4, 1, 3);
INSERT INTO Product_Provider_Unit(id_prod, id_prov, id_uni) VALUES (5, 2, 4);

INSERT INTO trimester(open, name) VALUES (1, 'III 2017');