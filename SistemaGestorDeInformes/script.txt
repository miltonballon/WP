CREATE TABLE `Invoice` (
	`id`			INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	`n_invoice`		INTEGER,
	`n_autorization`	INTEGER,
	`id_provider`		INTEGER,
	`nit`			INTEGER,
	`date`			TEXT,
	`id_trimester`		INTEGER,
	FOREIGN KEY(`id_provider`) REFERENCES `Provider`(`id`),
	FOREIGN KEY(`id_trimester`) REFERENCES `trimester`(`id`)
	CONSTRAINT n_invoice_provider_unique UNIQUE (n_invoice, id_provider)
);

CREATE TABLE `Product` (
	`id`	INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	`name`	TEXT
);
CREATE TABLE `Provider` (
	`id`	INTEGER PRIMARY KEY AUTOINCREMENT,
	`Provider`	TEXT,
	`NIT`		INTEGER
	
);
CREATE TABLE `Unit` (
	`id`	INTEGER PRIMARY KEY AUTOINCREMENT,
	`Type`	TEXT
);
CREATE TABLE `Product_Provider_Unit` (
	`id`	INTEGER PRIMARY KEY AUTOINCREMENT,	
	`id_prod`	INTEGER,
	`id_prov`	INTEGER,
	`id_uni`	INTEGER,
	FOREIGN KEY(`id_prov`) REFERENCES `Provider`(`id`),
	FOREIGN KEY(`id_uni`) REFERENCES `Unit`(`id`),
	FOREIGN KEY(`id_prod`) REFERENCES `Product`(`id`)
);

CREATE TABLE `invoice_row` (
	`id`		INTEGER PRIMARY KEY AUTOINCREMENT,
	`id_invoice`	INTEGER,
	`id_ppu`	INTEGER,
	`quantity`	TEXT,
	`unit_price`	TEXT,
	`total` 	TEXT,
	FOREIGN KEY(`id_ppu`) REFERENCES `Product_Provider_Unit`(`id`),
	FOREIGN KEY(`id_invoice`) REFERENCES `Invoice`(`id`)	
);

CREATE TABLE `Configuration` (
	`id`		INTEGER PRIMARY KEY AUTOINCREMENT,
	`scholarships`	INTEGER,
	`n_departure`	INTEGER
);

CREATE TABLE `trimester` (
	`id`		INTEGER PRIMARY KEY AUTOINCREMENT,
	`open`		INTEGER,
	`name`		TEXT
);

CREATE TABLE `User` (
	`id`		INTEGER PRIMARY KEY AUTOINCREMENT,
	`name`	TEXT,
	`password`	TEXT,
	`email`	TEXT
);
CREATE TABLE `Reception` (
	`id`	INTEGER PRIMARY KEY AUTOINCREMENT,
	`ppu_id`	INTEGER,
	`receptionDate`	TEXT,
	`expirationDate`	TEXT,
	`total`	INTEGER,
	FOREIGN KEY(`ppu_id`) REFERENCES `Product_Provider_Unit`(`id`)
);
CREATE TABLE `OutputReception` (
	`id`	INTEGER PRIMARY KEY AUTOINCREMENT,
	`id_reception`	INTEGER,
	`output_total`	INTEGER,
	`output_date`	TEXT,
	FOREIGN KEY(`id_reception`) REFERENCES `Reception`(`id`)
);
INSERT INTO User(name, password, email) VALUES ('Responsable','creamos', 'jprodriguez60@gmail.com');

INSERT INTO Product(name) VALUES ('Pan');
INSERT INTO Product(name) VALUES ('Leche');
INSERT INTO Product(name) VALUES ('Carne Para Sopa');

INSERT INTO Unit(Type) VALUES ('Bolsa');
INSERT INTO Unit(Type) VALUES ('Lts.');
INSERT INTO Unit(Type) VALUES ('Kg.');

INSERT INTO Provider(Provider, NIT) VALUES ('HiperMaxi',123);

INSERT INTO Product_Provider_Unit(id_prod, id_prov, id_uni) VALUES (1, 1, 1);
INSERT INTO Product_Provider_Unit(id_prod, id_prov, id_uni) VALUES (2, 1, 2);
INSERT INTO Product_Provider_Unit(id_prod, id_prov, id_uni) VALUES (3, 1, 3);


INSERT INTO trimester(open, name) VALUES (0, 'II 2017');
INSERT INTO trimester(open, name) VALUES (1, 'III 2017');